{{- if and (eq .chezmoi.os "darwin") (has "dev" .tags) -}}
#!/bin/bash

set -euo pipefail

source "{{ .chezmoi.sourceDir -}}/scripts/shared-utils.sh"

if ! require_tools curl; then
    exit 1
fi

if command_exists rustup; then
    print_message "info" "Rust is already installed. Updating..."
    rustup update
    exit 0
fi

print_message "info" "Downloading and installing Rust via rustup..."
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

print_message "success" "Rust installed successfully!"
print_message "info" "You may need to restart your terminal or run 'source ~/.cargo/env'"

{{ end -}}