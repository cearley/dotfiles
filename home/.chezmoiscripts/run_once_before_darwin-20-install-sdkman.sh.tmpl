{{- if and (eq .chezmoi.os "darwin") (has "dev" .tags) -}}
#!/bin/bash

set -euo pipefail

source "{{ .chezmoi.sourceDir -}}/scripts/shared-utils.sh"

if ! require_tools curl zip unzip; then
    exit 1
fi

# Exit immediately if sdkman is already installed
if [[ -d "$HOME/.sdkman" ]] && [[ -f "$HOME/.sdkman/bin/sdkman-init.sh" ]]; then
    print_message "skip" "Skipping sdkman installation: sdkman is already installed"
    exit 0
fi

print_message "info" "Installing sdkman (Software Development Kit Manager)..."

# Install sdkman using the official installation script from sdkman.io
export SDKMAN_DIR="$HOME/.sdkman"
curl -s "https://get.sdkman.io" | bash

print_message "success" "sdkman installed successfully!"
print_message "info" "sdkman installed to: $SDKMAN_DIR"

{{ end -}}