{{- if and (eq .chezmoi.os "darwin") (has "ai" .tags) (output "command" "-v" "uvx") -}}
#!/bin/bash

# Install Basic Memory MCP server for Claude Desktop
# Prerequisite: uv (installed by run_once_before_darwin-15-install-uv.sh.tmpl)

echo "ðŸ¤– Installing Basic Memory MCP server for Claude Desktop..."

# Skip if basic-memory is already installed.
if uvx basic-memory --version >/dev/null 2>&1; then
    echo "âœ… Skipping basic-memory installation: basic-memory is already installed"
    exit 0
fi

# Install Basic Memory via the recommended installer
# This will install uv (if not already installed), install Basic Memory via uv,
# and configure Claude Desktop automatically with user permission.
curl -LsSf https://basicmemory.com/install/latest.sh | sh

echo "Basic Memory MCP server installation completed"
{{ end -}}